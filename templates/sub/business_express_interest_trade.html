{% load static %}
<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-141253078-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-141253078-2');
</script>
  <title>Billntrade</title>
  <meta content="" name="description">
  <meta content="" name="keywords">


        {% block title %}

        {% endblock %}
    </title>
    <!-- Bootstrap core CSS -->
<link href="{% static 'css/bootstrap.min.css' %}" rel="stylesheet">
<link href="{% static 'css/main.css' %}" rel="stylesheet">
<link rel="icon" type="image/png" href='/static/img/favicon-32x32.png'>

    <!-- Custom styles for this template -->
    <link href="{% static 'css/dashboard.css' %}" rel="stylesheet">
  </head>
  <body>
  <!-- ======= Header ======= -->
    <nav class="navbar navbar-expand-lg navbar-light sticky-top bg-light py-0 class">
        <a href=""><img src="{% static 'img/Logo.png' %}" alt="" class="img-fluid brand"></a>
          <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav"
          aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
  <div class="d-flex ml-auto">
  <div class="collapse navbar-collapse" id="navbarNav">
  <ul class="navbar-nav">
  </ul>
  <ul class="navbar-nav ml-auto mr-5">
      <li class="nav-item dropdown ml-auto">
          <a class="nav-link dropdown-toggle" 
              id="navbarDropdownMenuLink" role="button" data-toggle="dropdown" 
              aria-haspopup="true" aria-expanded="false">{{request.user}}</a>
  
          <div class="dropdown-menu dropdown-menu-right">
              <a class="dropdown-item" href="{% url 'logout-view' %}">Logout</a>
          </div>
      </li>
  </ul>
  </div>
  </nav>
<div class="container-fluid">
  <div class="row">
    {% include 'partials/_bus_express_interest_trade.html' %}
    <main role="main" class="col-md-9 ml-sm-auto col-lg-10 px-md-4">
      {% block content %}

        <div class="card mt-3 style=width: 18rem;">
    
        <div class="card">
                <div class="col-auto mt-3">
                        <h6>Create expression note</h6>
                  
            <div class="card-body">
                <form action="{% url 'business-create-trade-interest-quote' quote.id %}" method="POST">

                    {% include 'partials/_messages.html' %}
                    {% csrf_token %}
                    
                    
                            <div class="form-row"> 
                                <div class="form-group col-md-3"> 
                                    <label for="QuoteID">RFQ ID:</label>
                                    <input type="text" class="form-control" name="quoteid" id="quoteidField" value="{{values.Quoteid}}" readonly>
                                    </div>
                                <div class="form-group col-md-3"> 
                                      <label for="ExpressID">Express interest ID:</label>
                                      <input value="{{ exprintid }}" type="text" class="form-control" name="exprintid" id="exprintidField" value="{{values.exprintid}}" readonly>
                                      <small id="quoteiDHelpBlock" class="form-text text-muted">
                                            Express interest ID autogenerated
                                      </small>
                                  </div> 
                                <div class="form-group col-md-3"> 
                                    <label for="Status">Status:</label>
                                    <input type="text" class="form-control" name="status" id="statusField" value="{{values.status}}" readonly>
                                </div>
                                <div class="form-group col-md-3">
                                        <label for="Date">Date business created expr. int:</label>
                                        <input type="text" class="form-control" name="datecreated" id="dateField" value="{{values.datecreated}}" readonly>
                                        <small id="datecreatedHelpBlock" class="form-text text-muted">
                                            Date auto created on send
                                        </small>
                                </div>
                              </div>
                                <div class="form-row"> 
                                    <div class="form-group col-md-1"> 
                                    <label for="Title">Title:</label>
                                    <input type="text" class="form-control" name="title" id="titleField" value="{{values.title}}" readonly>
                                  </div>   
                                  <div class="form-group col-md-2"> 
                                    <label for="Firstname">Firstname:</label>
                                    <input type="text" class="form-control" name="firstname" id="firstnameField" value="{{values.firstname}}" readonly>
                                  </div>      
                                  <div class="form-group col-md-3">
                                    <label for="Surname">Surname:</label>
                                    <input type="text" class="form-control" name="surname" id="surnameField" value="{{values.surname}}" readonly>
                                  </div>
                                  <div class="form-group col-md-3">
                                      <label for="mobile">Mobile:</label>
                                      <input type="text" class="form-control" name="mobile" id="mobileField" value="{{values.mobile}}" readonly>
                                    </div>
                                  <div class="form-group col-md-3">
                                        <label for="email">Email:</label>
                                        <input type="text" class="form-control" name="email" id="emailField" value="{{values.email}}" readonly>
                                  </div>
                                  <div class="form-group col-md-3">
                                      <label for="Add ovner">Add contact details:</label>
                                      <td><a data-toggle="modal" data-target="#addCreatorModal" style="color: black"  type="nav-link" value="submit" onclick="call_creator()" class="btn btn-outline-secondary">Add</a></td>
                                  </div>
                                  </div>
                                  <div class="form-row">                              
                                  <div class="form-group col-md-3"> 
                                    <label for="Address1">Business name:</label>
                                    <input type="text" class="form-control" name="businessname" id="businessField" value="{{values.address1}}" readonly>
                                  </div>
                                  <div class="form-group col-md-3"> 
                                    <label for="Address1">Address 1:</label>
                                    <input type="text" class="form-control" name="address1" id="address1Field" value="{{values.address1}}" readonly>
                                  </div>  
                                    <div class="form-group col-md-3"> 
                                        <label for="Address2">Address 2:</label>
                                        <input type="text" class="form-control" name="address2" id="address2Field" value="{{values.address2}}" readonly>
                                     </div>      
                                    <div class="form-group col-md-3">
                                        <label for="Town">Town:</label>
                                        <input type="text" class="form-control" name="town" id="townField" value="{{values.town}}" readonly>
                                    </div>
                                    <div class="form-group col-md-2">
                                            <label for="City">City:</label>
                                            <input type="text" class="form-control" name="city" id="cityField" value="{{values.city}}" readonly>
                                          </div>
                                    <div class="form-group col-md-2">
                                            <label for="County">County:</label>
                                            <input type="text" class="form-control" name="county" id="countyField" value="{{values.county}}" readonly>
                                    </div> 
                                    <div class="form-group col-md-2">
                                            <label for="Postcode">Postcode:</label>
                                            <input type="text" class="form-control" name="postcode" id="postcodeField" value="{{values.postcode}}" readonly>
                                    </div>
                                    <div class="form-group col-md-3">
                                        <label for="Postcode">Website:</label>
                                        <input type="text" class="form-control" name="website" id="websiteField" value="{{values.website}}" readonly>
                                    </div>
                                    <div class="form-group col-md-3">
                                        <label for="VATnumber">VAT number:</label>
                                        <input type="text" class="form-control" name="vatnumber" id="vatnumberField" value="{{values.vatnumber}}" readonly>
                                    </div>
                                    <div class="form-group col-md-3">
                                      <label for="Add property">Add business details:</label>
                                      <td><a type="nav-link" data-toggle="modal" data-target="#addAddressModal" style="color: black" value="submit" onclick="call_address()" class="btn btn-outline-secondary">Add</a></td>
                                    </div>  
                                    <div class="form-group col-md-12">
                                            <label for="exampleFormControlTextarea2">Express interest in RFQ:</label>
                                            <input type="text" class="form-control"  rows="2" name="comments" id="additionalcommentsField" value="{{values.comments}}">
                                    </div>
                                    <div class="col-auto my-1">
                                      <button type="submit" style="color: black" value="submit" class="btn btn-outline-primary btn-block">Send</button>
                                      </div>
                                      </div>
                                    </div>
                                  </div>
                            </form>
                        </div>
                </div>
         </div>
         <div class="mb-3"></div>
         <div class="modal fade" id="addCreatorModal" tabindex="-1" role="dialog" aria-labelledby="addCreatorModalLabel"
         aria-hidden="true">
        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h6 class="modal-title" id="addCreatorModalLabel">Add contact details</h6>
                    <button class="close" type="button" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">×</span>
                    </button>
                </div>
                <div class="modal-body">
                    <table class="table table-striped">
                        <thead>
                          <tr>
                            <th scope="col">Title</th>
                            <th scope="col">Firstname</th>
                            <th scope="col">Surname</th>
                            <th scope="col">Moblie</th>
                            <th scope="col">Email</th>
                            <th scope="col">Action</th>
                          </tr>
                        </thead>
                        <tbody id="creator_add">
                        </tbody>
                      </table>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" type="button" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
    <div class="modal fade" id="addAddressModal" tabindex="-1" role="dialog" aria-labelledby="addAddressModalLabel"
         aria-hidden="true">
        <div class="modal-dialog modal-xl" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h6 class="modal-title" id="addAddressModalLabel">Add business details</h6>
                    <button class="close" type="button" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">×</span>
                    </button>
                </div>
                <div class="modal-body">
                    <table class="table table-striped">
                        <thead>
                          <tr>
                            <th scope="col">Business Name</th>
                            <th scope="col">Address 1</th>
                            <th scope="col">Address 2</th>
                            <th scope="col">Town</th>
                            <th scope="col">City</th>
                            <th scope="col">County</th>
                            <th scope="col">Postcode</th>
                            <th scope="col">Website</th>
                            <th scope="col">VAT number</th>
                            <th scope="col">Action</th>
                          </tr>
                        </thead>
                        <tbody id="address_add">
                        </tbody>
                      </table>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" type="button" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
      </div>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
        <script src="{% static 'js/bootstrap.feather.js' %}"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.3/Chart.min.js"></script>
        <script src="{% static 'js/min.js' %}" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
        <script src="{% static 'js/main.js' %}"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
        <script src="{% static 'js/function.js' %}"></script>
        <script src="https://unpkg.com/feather-icons@4.10.0/dist/feather.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

        <script>
$(document).ready(function(){
   feather.replace();

   $('button').click(function(){
      $('.alert').html('<i data-feather="activity"></i>');
      feather.replace();
   });

});
</script>
        <script>
           function call_creator(sym) {
            $.ajax({
                url: '{% url 'get-ajax-creator' %}',
                method: 'GET',
                dataType: 'json',
                success: function (main_data) {
                  let row_data = ''
                  let data = JSON.parse(main_data);
                  for(i=0; i<data.length; i++){
                    const item = data[i].fields;
                    row_data = row_data + `<tr>
                      <td class="align-middle">${item.Title}</td>
                      <td class="align-middle">${item.Firstname}</td>
                      <td class="align-middle">${item.Surname}</td>
                      <td class="align-middle">${item.Mobile}</td>
                      <td class="align-middle">${item.Email}</td>
                      <td class="align-middle"><button data-key="${item.id}" data-title="${item.Title}" data-fname="${item.Firstname}" data-sname="${item.Surname}" data-mobile="${item.Mobile}" data-email="${item.Email}"   onclick="selectCreator(this)" class="btn btn-primary">Add</button></td>
                      </tr>
                      `
                  }
                  $("#creator_add").html(row_data);
                },
                error: function (err) {
                    console.error("error getting data")
                }
            });
        }
        function call_address(sym) {
            $.ajax({
                url: '{% url 'get-ajax-address' %}',
                method: 'GET',
                dataType: 'json',
                success: function (main_data) {
                  let row_data = ''
                  let data = JSON.parse(main_data);
                  for(i=0; i<data.length; i++){
                    const item = data[i].fields;
                    row_data = row_data + `<tr>
                      <td class="align-middle">${item.Businessname}</td>
                      <td class="align-middle">${item.Address1}</td>
                      <td class="align-middle">${item.Address2}</td>
                      <td class="align-middle">${item.Town}</td>
                      <td class="align-middle">${item.City}</td>
                      <td class="align-middle">${item.County}</td>
                      <td class="align-middle">${item.Postcode}</td>
                      <td class="align-middle">${item.Website}</td>
                      <td class="align-middle">${item.VATnumber}</td>
                      <td class="align-middle"><button data-key="${item.id}" data-biz="${item.Businessname}" data-add1="${item.Address1}" data-add2="${item.Address2}" data-town="${item.Town}" data-city="${item.City}" data-county="${item.County}" data-post="${item.Postcode}" data-web="${item.Website}" data-vatnumber="${item.VATnumber}" onclick="selectAddress(this)" class="btn btn-primary">Add</button></td>
                      </tr>
                      `
                  }
                  $("#address_add").html(row_data);
                },
                error: function (err) {
                    console.error("error getting data")
                }
            });
        }
        function selectCreator(e){
          const data = $(e);
          $("#titleField").val(data.attr("data-title"));
          $("#firstnameField").val(data.attr("data-fname"));
          $("#surnameField").val(data.attr("data-sname"));
          $("#mobileField").val(data.attr("data-mobile"));
          $("#emailField").val(data.attr("data-email"));
          $('.modal').removeClass('show');
          $(document.body).removeClass('modal-open');
          $('.modal-backdrop').remove();
        }
        function selectAddress(e){
          const data = $(e);
          $("#businessField").val(data.attr("data-biz"));
          $("#address1Field").val(data.attr("data-add1"));
          $("#address2Field").val(data.attr("data-add2"));
          $("#townField").val(data.attr("data-town"));
          $("#cityField").val(data.attr("data-city"));
          $("#countyField").val(data.attr("data-county"));
          $("#postcodeField").val(data.attr("data-post"));
          $("#websiteField").val(data.attr("data-web"));
          $("#vatnumberField").val(data.attr("data-vatnumber"));
          $('.modal').removeClass('show');
          $(document.body).removeClass('modal-open');
          $('.modal-backdrop').remove();
        }
        </script>

<style>
    .brand {
        height: auto;
        width: auto;
        max-height: 72px;
        max-width: 250px;
    }
  </style>
      </body>
{% endblock %}
</html>